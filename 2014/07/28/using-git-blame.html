<!DOCTYPE html>
<!--[if IE 9]><html class="lt-ie10" lang="en" prefix="og: http://ogp.me/ns#"> <![endif]-->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  


  <title>Using git-blame to Understand the Intention of Code</title>
  <meta property="og:title" content="Using git-blame to Understand the Intention of Code" />



  



  <meta name="description" content="While reading through Figaro&#39;s env_spec.rb, I came across this test:
" />
  <meta property="og:description" content="While reading through Figaro&#39;s env_spec.rb, I came across this test:
" />


<link rel="canonical" href="http://serixscorpio.github.io/2014/07/28/using-git-blame.html" />
<meta property="og:url" content="http://serixscorpio.github.io/2014/07/28/using-git-blame.html" />
<meta property="og:site_name" content="Random Walks in Gems" />

<meta property="og:updated_time" content="2014-07-28T00:00:00+00:00" />






  <meta property="keywords" content="blog,personal" />
















  <link type="text/plain" rel="author" href="humans.txt" />
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.0/webfont.js"></script>
  <link rel="stylesheet" href="http://serixscorpio.github.io/assets/app-b03a128dc9c29006ca25e435f5fc25b9.css">
  <script>(function(){"use strict";WebFont.load({google:{families:["Ubuntu"]}})}).call(this);</script>
  <script src="http://serixscorpio.github.io/assets/head-20ade4d99b635d94e5ec57b12ffc9c92.js"></script>
</head>

<body>

  <article>
  <header class="hero">
    <h1>Using git-blame to Understand the Intention of Code</h1>
    <p>28 Jul 2014</p>
  </header>

  <div class="container">
    <div class="row section-content">
      <div class="large-10 large-offset-1 columns">
        <p>While reading through Figaro&#39;s <a href="https://github.com/laserlemon/figaro/blob/master/spec/figaro/env_spec.rb">env_spec.rb</a>, I came across this test:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">describe</span> <span class="s2">&quot;#method_missing&quot;</span> <span class="k">do</span>
  <span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="n">context</span> <span class="s2">&quot;plain methods&quot;</span> <span class="k">do</span>
    <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="n">it</span> <span class="s2">&quot;respects a stubbed plain method&quot;</span> <span class="k">do</span>
      <span class="n">env</span><span class="o">.</span><span class="n">stub</span><span class="p">(</span><span class="ss">bar</span><span class="p">:</span> <span class="s2">&quot;baz&quot;</span><span class="p">)</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">bar</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>At first sight, this test doesn&#39;t seem to be doing much.  I could not figure out what the <code>&quot;respects a stubbed plain method&quot;</code> means, but it most likely is testing some specific behavior in Figaro.  Fortunately, Joost Baaij, my mentor on Ruby and Rails, pointed out using <a href="http://git-scm.com/docs/git-blame"><code>git blame</code></a> to understand the intention of this piece of code:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&gt; git blame spec/figaro/env_spec.rb -L 32
da9ec5cd (Steve Richert 2014-04-17 15:24:52 -0400  32)       it &quot;respects a stubbed plain method&quot; do
da9ec5cd (Steve Richert 2014-04-17 15:24:52 -0400  33)         env.stub(bar: &quot;baz&quot;)
da9ec5cd (Steve Richert 2014-04-17 15:24:52 -0400  34)         expect(env.bar).to eq(&quot;baz&quot;)
da9ec5cd (Steve Richert 2014-04-17 15:24:52 -0400  35)       end
4655694d (Steve Richert 2013-05-01 12:41:26 -0700  36)     end
4655694d (Steve Richert 2013-05-01 12:41:26 -0700  37) 
...
</code></pre></div>
<p>I used git blame with the <code>-L 32</code> option to only show change history of line 32 in <a href="https://github.com/laserlemon/figaro/blob/master/spec/figaro/env_spec.rb">env_spec.rb</a>.  Alternatively, one can also use github to get the equivalent <a href="https://github.com/laserlemon/figaro/blame/master/spec/figaro/env_spec.rb#L32">result</a>.  In both cases, we see <a href="https://github.com/laserlemon/figaro/commit/da9ec5cdb8c1cc2546ce230aa075bcefc7c79640">da9ec5cd</a> as the lastest commit that modified line 32.
```</p>

<blockquote>
<p>git log -L 32,32:spec/figaro/env_spec.rb da9ec5cd
commit da9ec5cdb8c1cc2546ce230aa075bcefc7c79640
Author: Steve Richert <a href="mailto:steve.richert@gmail.com">steve.richert@gmail.com</a>
Date:   Thu Apr 17 15:24:52 2014 -0400</p>
</blockquote>
<div class="highlight"><pre><code class="language-text" data-lang="text">Make Figaro::ENV bang/boolean methods make use of the plain methods

This allows a developer to stub the plain method and the corresponding
bang/boolean methods will work as expected. Otherwise, the developer
would have to stub all three methods separately.
</code></pre></div>
<p>diff --git a/spec/figaro/env<em>spec.rb b/spec/figaro/env</em>spec.rb
--- a/spec/figaro/env<em>spec.rb
+++ b/spec/figaro/env</em>spec.rb
@@ -31,0 +32,1 @@
+      it &quot;respects a stubbed plain method&quot; do
``<code>
Here I use</code>git log<code>with the</code>-L<code>option and specified the commit found from</code>git blame<code>.  The</code>-L` option allows me to specify the file and line number I am interested in.</p>

<p>Let&#39;s take a look at the commit message.  Ah! Mystery solved.  This test is to ensure Figaro knows how to handle messages <code>bar</code>, <code>bar!</code>, and <code>bar?</code> when a single<code>stub(bar: &quot;baz&quot;)</code> is defined.  This behavior alleviates the user from having to define three separate methods when stubbing (one plain method, one bang method, and one boolean method).</p>

<p>Finally, this example highlights the importance of a good commit message.  When done right, as in this case, it communicates the intention of the code to other very effectively.</p>


        
      </div>
    </div>
  </div>
</article>


  <footer>
    

  </footer>




  <script>    'use strict';    yepnope([          {        load: 'https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js',        complete: function () {          if ( !window.jQuery ) {            yepnope('http://serixscorpio.github.io/assets/jquery/dist/jquery-fc13c39852cdf78bcdc4828979ea36d2.js');          }        }      },          'http://serixscorpio.github.io/assets/app-c98f6bcc94867897539baf456375fdab.js'    ]);              </script>
</body>
</html>
